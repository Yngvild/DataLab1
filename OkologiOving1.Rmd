---
title: "Datalab 1 generell økologi: Konkurranse og "
author: "Y. Vindenes"
output: html_document
---

<br>

De to datalabene i BIOS2100 er ment som en hjelp til å forstå de delene av læreboka som omhandler populasjonsdynamikk og interaksjoner (konkurranse, parasittisme og predasjon).




###Før øvingen: Installere shiny-apps i R
I øvingen skal vi benytte shiny-apps, interaktive web-applikasjoner basert på R. Shiny-apps gjør det mulig å studere ulike økologiske modeller ved hjelp av grafer og enkle barer for å endre modell-parameterne, uten å gå inn i selve R-koden (dette er selvsagt også mulig for den som er interessert, men da må man gjerne ha mer enn to timer til rådighet).  Shiny-appene vi skal bruke er laget av Ottar N. Bjørnstad (onb1@psu.edu), Penn State University. Først må du installere disse, sammen med noen andre nødvendige pakker, i R. Lag en mappe for øvingen, og legg filen "oshinys_0.1-1.zip" der.  Åpne R (eller RStudio), og kopier denne koden inn i R-konsollen (NB: "yourpath" må byttes ut med filadressen til mappen):

```{r}
install.packages(c("shiny", "deSolve", "scatterplot3d", "polspline", "phaseR"))
#install.packages("/yourpath/oshinys_0.1-1.zip", repos = NULL, type = "source")
#install.packages("/Users/yngvildv/Dropbox/WorkRelated/UndervisningUiO/BIO2100 Generell økologi/Yngvild/oshinys_0.1-1.zip", repos = NULL, type = "source")
install.packages("/Users/yngvildv/Dropbox/WorkRelated/UndervisningUiO/BIO2100 Generell økologi/Yngvild/oshinys_0.1-1.tar", repos = NULL, type = "source")
#require(oshinys)
```

<br>
Nå kan vi bruke 


###Mål for øvingen
I denne øvingen skal vi se nærmere på hvordan dynamikken mellom konkurrenter og ulike parasittsystemer påvirkes av endringer ved noen av modellparameterne (vekstrate, bæreevne etc.).
 
* Lage en R-funksjon som simulerer enkel populasjonsvekst over tid.

* Sette opp en stadie-strukturert modell og lage en funksjon som simulerer populasjonsvekst.

* Finne populasjonsvekstrate og stabil stadiestruktur, og reproduktive verdier.

* Finne ut hvor mye hver stadie-spesifikk parameter for overlevelse og reproduksjon må økes for å oppnå en stabil populasjon.

* Gi råd om bevaring av populasjonen.


<br>

### Introduksjon havskilpadder
Anta at du er en bevaringsbiolog som har fått i oppgave å ivareta en populasjon av havskilpadden glattkarett  (*Caretta caretta*). Måletl er å sørge for at den langsiktige populasjonsvekstraten $r=\ln \lambda$ er positiv slik at populasjonen er levedyktig. Havskilpadder er langlevde dyr og det er stor forskjell på unge og eldre individer, og hvilke tiltak som kan settes inn for hvert stadie.  Det er derfor viktig å forstå hvordan prosesser som overlevelse og vekst i ulike livsstadier påvirker populasjonsveksten, slik at de mest sårbare stadiene kan identifiseres.  


![**Figur 1.** Glattkarett (*Caretta caretta*). ](loggerhead.jpg){width=500px}

<br>

###Oppgave 0 - Populasjonsvekst uten struktur
Før vi ser på skilpaddenesnpopulasjonsvekst, skal vi lage en funksjon i R som simulerer populasjonsvekst over tid for en populasjon der alle individer er like (ingen struktur).  Dersom populasjonsstørrelsen i år $t$ er $N_t$, er neste års størrelse gitt ved

$$N_{t+1}=\lambda N_t,$$

der $\lambda$ er den årlige multiplikative vekstraten til populasjonen.

* Hvilke antakelser ligger bak en slik populasjonsmodell? Hvilke organismer og situasjoner kan den passe for?

Vi kan lage en funksjon i R som returnerer populasjonsveksten over tid basert på denne enkle modellen. Input-verdier til funksjonen er vekstraten ($\lambda$), startverdien til populasjonen ($N_{0}$) og antall ønskede tidssteg ($T_{max}$). Funksjonen skal returnere en vektor, der hvert element tilsvarer populasjonsstørrelsen i et tidssteg, $[N_0,N_1,...,N_{t_{max}}]$. En slik funksjon kan lages på flere ulike måter, for eksempel ved å bruke en for-løkke der en ny verdi for populasjonsstørrelsen regnes ut for hvert tidssteg, gitt verdien i det forrige tidssteget (hvis du vil vite mer om for-løkker og å lage egne funksjoner i R, se [her](https://markravinet.github.io/Chapter10.html))

<br>
 
  
```{r}
Popvekst.0 <- function(Tmax=10, N0=10, lambda=1.05){
  Nvek <- rep(NA, ncol=Tmax+1) #Lag tom vektor
  Nvek[1] <- N0 #Sett inn startverdi for populasjonen
  for (i in 2:(Tmax+1)){ #for-loop for å regne ut populasjonsstørrelse hvert tidssteg
    Nvek[i]<- lambda*Nvek[i-1] 
  }
  Nvek
}
```

<br>

* Plott noen realisasjoner av populasjonsvekst basert på denne R-funksjonen, for ulike verdier av $\lambda$ (prøv verdier over og under 1) og startpopulasjon $N_0=10$. Hva viser disse?

<br>

```{r}
par(mfrow=c(1,1), bty="l", cex=1)
sim1 <- Popvekst.0()
sim2 <- Popvekst.0(lambda=1)
sim3 <- Popvekst.0(lambda=.95)
ylims =c(0,max(sim1, sim2, sim3)) #sett opp y-akse så alle plott kommer på samme skala

plot(sim1,type="l",xlab="Tid", ylab="Populasjon", ylim=ylims,lwd=2,main="")
lines(sim2,col=2, lwd=2)
lines(sim3,col=3, lwd=2)

```

Denne R-funksjonen er utgangspunkt for oppgave 2, der du skal studere populasjonsveksten til havskilpaddene. 
<br>


 
###Oppgave 1  Livstabell og livssyklus
Populasjonen av havskilpadder telles en gang i året, rett etter reproduksjon. Basert på disse dataene har du følgende livstabell tilgjengelig som gir informasjon om livsstadier, overlevelse, og fekunditet for hunner (tilpasset fra tabell 2, Crowder  et al., 1994$^1$):

Stadie  | Stadienavn | Størrelse (cm) | Alder (år) | Overlevelse | Fekunditet  
------------- | -------------| -------------| -------------| -------------| -------------
1  | nyklekket | <10 | 0 | 0.67 | 0
2  |  liten juvenil | 10.1-58.0 |1-7 | 0.74 | 0
3 |  stor juvenil | 58.1-80.0   |8-15 | 0.74 | 0
4 |  sub-adult  |  80.1-87.0   |16-21 | 0.74 | 0
5 |  adult |  >87   | >22 | 0.81 | 76.5
 
 <br>
Livssyklusen til skilpaddene kan også oppsummeres i en livssyklusgraf (figur 2), som viser overgangene mellom de ulike stadiene fra år til år: 


![**Figur 2**. Livssyklusgraf basert på stadiestruktur. $P_{j}$ indikerer sannsynlighet for å overleve og bli værende i samme stadie, $G_j$ er sannsynligheten for å overleve og vokse til neste stadie, mens $F_{j}$ er reproduksjon. ](Livssyklus4.png){width=600px}


 <br>
 
For hvert tidssteg er det altså flere ting som kan skje med et individ: 

* Individet kan dø og gå ut av populasjonen.

* Individet kan overleve og bli værende i samme stadie, med sannsynlighet $P_{j}$.

* Individet kan overleve og gå inn i neste stadie $i$ med sannsynlighet $G_{j}$.

* Individet kan reprodusere (hvis voksen), og bidra med $F_i$ nyklekkede unger til neste års populasjon.  NB: Denne parameteren avhenger av overlevelsen til de voksne frem til neste tidssteg, i tillegg til antall nyklekkede som blir produsert gitt overlevelse.  Selv om ingen sub-adulte individer reproduserer, vil noen av dem bli voksne i løpet av det nåværende tidssteget og dermed kunne bidra til neste års produksjon av unger. 

Sammen vil paremeterne $P_{j}$,  $G_{j}$ og  $F_{j}$ bestemme hvordan populasjonen utvikler seg fra et år til neste. Populasjonsvekst i strukturerte modeller kan beskrives med en *matrisemodell* der man følger antall individer i hvert stadie over tid. Dette kommer vi tilbake til i oppgave 2. Først skal du finne $P_i$, $G_i$ og $F_i$ (figur 2) basert på livstabellen, og sette opp vektorer i R som inneholder verdiene for hvert stadie.



* Lag vektorer i R for stadie-spesifikk overlevelses-sannsynlighet $p=[p_0,...,p_5]$, varighet $d=[d_0,...,d_5]$, og fekunditet  $m=[m_0,...,m_5]$, basert på verdiene i tabell 1. Det siste stadiet har potensielt uendelig varighet, så her kan du sette inn et stort tall.

```{r´}
#Overlevelse 
p <- c(0.67 , .74, .74, .74, .81)

#Varigheten for stadie (fra alderskolonnen i livstabellen)
d <- c(1, 7, 8, 6, 1000) #I siste stadie blir de værende resten av livet, her må vi bare sette inn et høyt tall 

#Fekunditeten (antall nyklekkede per hunn) fra livstabellen er:
m <-  c(0,0,0,0,76.5)
```
  
  
* Finn overgangssannsynlighetene mellom ulike stadier fra år til år, basert på disse formlene fra Crouse et al., 1987 :

1. Sannsynligheten for å overleve og bli værende i samme stadie, der $d_i$ er varigheten i stadie $i$: $$P_i = p_i\frac{1-p_i^{d_i-1} }{1-p_i^{d_i}}$$.
  
2. Sannsynligheten for å overleve og gå inn i (vokse til) neste stadie: $$G_i =  \frac{p_i^{d_i}(1-p_i)}{1-p_i^{d_i}}$$.
  
* Finn deretter gjennomsnittlig reproduksjon for stadie 4 og 5 (hint: neste års antall avkom avhenger av foreldrenes overlevelse i tillegg til fekunditet).

```{r}
#Sannsynligheten for å overleve og bli værende i samme stadie:
P <-  ((1-p^(d-1))/(1-p^d))*p 
  
#Sannsynligheten for å overleve og gå over til neste stadie er:
G <- p^d*(1-p)/(1-p^d) 
  
#Gjennomsnittlig reproduksjon:
F4 <- G[4]* m[5] #Reproduksjon fra stadie 4 (fra de som overlever og blir voksne) 

F5 <- P[5]* m[5] #Reproduksjon fra stadie 5 (fra de som overlever) 
```

###Oppgave 2 - Projeksjonsmatrise og populasjonsvekst
Matrisemodeller brukes for strukturerte populasjoner, slik som disse skilpaddene. Et sentralt element i slike modeller er *projeksjonsmatrisa*, som beskriver hvordan antallet individer i de ulike stadiene vil endres over tid, basert på livshistorieparametrene (som du nettopp har regnet ut). Populasjonsveksten fra et år til neste er gitt av matriselikningen $\mathbf{n}_{t+1}= \mathbf{L}\mathbf{n}_t$, der $\mathbf{n}_t=[n_1, n_2, n_3,n_4,n_5]_t$ er en vektor med antall individer i hvert stadie ved tid $t$, og $\mathbf{L}$ er projeksjonsmatrisa: 
 <br> 
 
$$\mathbf{L} = \left[ \begin{matrix} P_1&0&0&F_4&F_5\\ G_1&P_2&0&0&0\\ 0&G_2&P_3&0&0\\ 0&0&G_3&P_4&0\\ 0&0&0&G_4&P_5\\ \end{matrix}\right]$$ 
 
 <br> 
 

* Sett opp en slik matrise i R basert på verdiene for $G_i$, $P_i$ og $F_i$ som du regnet ut i oppgave 1 (bruk for eksempel funksjonen [matrix](https://www.rdocumentation.org/packages/base/versions/3.5.1/topics/matrix) til å lage en tom matrise, og sett deretter inn verdiene for hver vektor). 


```{r}
Lmat <- matrix(NA, 5, 5)

Lmat[1,] <- c(P[1], 0, 0, F4, F5)
Lmat[2,] <- c(G[1], P[2], 0, 0, 0)
Lmat[3,] <- c(0, G[2], P[3],  0, 0)
Lmat[4,] <- c(0, 0, G[3], P[4], 0)
Lmat[5,] <- c(0, 0, 0, G[4], P[5])
```

* Hva er hovedforskjellen på denne matrisa og en Leslie-matrise?


<br>

* Lag en funksjon i R som returnerer populasjonsvekst over tid ved hjelp av denne matrisa, og ta utgangspunkt i funksjonen fra oppgave 0.  Input-verdier til funksjonen skal være stadiematrisa ($\mathbf{L}$), startverdien til populasjonsvektoren ($\mathbf{n}_{0}$) og antall ønskede tidssteg ($T_{max}$). Funksjonen skal returnere en matrise der hver kolonne tilsvarer et tidssteg, og hver rad tilsvarer populasjonsvektoren i det tidssteget (eller omvendt).  Du kan bruke samme struktur på funksjonen som i oppgave 0, men nå må populasjonen lagres i en matrise.  Tips: I R skrives matrisemultiplikasjon slik (der ```Lmat``` er en matrise og ```Nvek``` en vektor):  

```
Lmat %*% Nvek
```
Bruk denne i en for-løkke for å finne populasjonsvektoren fra år til år.
 
 <br>
 
```{r}
Nstart <- c(10, 10, 10, 10, 10) #Startverdi for populasjonsvektoren

Popvekst <- function(Tmax=100, N0=Nstart, L=Lmat){
  Nmat <- matrix(NA, nrow=5, ncol=Tmax+1) #Kan være lurt å sette opp en tom matrise først, antall rader tilsvarer lengde på populasjonsvektoren, antall kolonner tilsvarer Tmax pluss 1 (første kolonne skal bestå av startverdiene)
  Nmat[,1] <- N0 #Sett inn startvektor for populasjonen
  for (i in 2:(Tmax+1)){ #
    Nmat[,i]<- L%*%Nmat[,i-1] 
  }
  Nmat
}
```

<br>

* Plott noen eksempler på populasjonsvekst med ulike startverdier (start med like mange individer i hvert stadie, med kun nyklekkede, eller med kun voksne). Lag et plott som viser veksten i hvert stadie, og deretter et som viser samlet populasjonsvekst. Hva ser du?  Hva er forskjellen på å starte populasjonen med kun voksne eller kun nyklekkede individer?


```{r, fig.width=12, fig.height=4}
sim1 <- Popvekst(N0=c(10, 10, 10, 10, 10)) #Start med like mange i hver 
sim2 <- Popvekst(N0=c(50,0,0,0,0)) #Start med kun nyklekkede
sim3 <- Popvekst(N0=c(0,0,0,0,50)) #Start med kun voksne

#Plotte hvert stadie
par(mfrow=c(1,3),bty="l", cex=1)
ylims =c(0,max(sim1, sim2, sim3)) #sett opp y-akse så alle plott kommer på samme skala
plot(sim1[1,],type="l",xlab="Tid", ylab="Populasjon", ylim=ylims,lwd=2,main="N0=[10,10,10,10,10]")
for(i in 2:5){
  lines(sim1[i,],col=i, lwd=2)
}

plot(sim2[1,],type="l",xlab="Tid", ylab="Populasjon",ylim=ylims,lwd=2,main="N0=[50,0,0,0,0]")
for(i in 2:5){
  lines(sim2[i,],col=i, lwd=2)
}
plot(sim3[1,],type="l",xlab="Tid", ylab="Populasjon",ylim=ylims,lwd=2,main="N0=[0,0,0,0,50]")
for(i in 2:5){
  lines(sim3[i,],col=i, lwd=2)
}
```

```{r, fig.width=8, fig.height=8}
#Plotte hele populasjonen samlet
par(mfrow=c(1,1),bty="l", cex=1)
N1 <- apply(sim1,2,sum)
N2 <- apply(sim2,2,sum)
N3 <- apply(sim3,2,sum)

ylims =c(0,max(N1,N2,N3)) #sett opp y-akse så alle plott kommer på samme skala
plot(N1,type="l",xlab="Tid", ylab="Populasjon", ylim=ylims,lwd=2)
lines(N2,col=2, lwd=2)
lines(N3,col=3, lwd=2)
 
#Disse plottene viser at populasjonen vil komme i nedgang uansett startverdi. Men starter man med kun voksne får man en større oppgang først.
``` 
 
<br> 


* Estimer den langsiktive vekstraten til populasjonen, $\lambda$, ved hjelp av R-funksjonen for populasjonsvekst. Du kan bruke estimatet $\hat{\lambda}=N_{T}/N_{T-1}$, der $T$ er stor nok til at populasjonen har nådd stabil struktur.  Hva betyr denne verdien for populasjonen?

```{r }
#Etter lang nok tid vil populasjonsveksten stabilisere seg, og vi kan estimere lambda basert på de to siste tidsstegene. Vi kan bruke de tre vektorene for populasjonsvekst fra forrige oppgave (da får vi også sjekket at resultatet blir det samme):
n <- length(N1)
lambda.est <- N1[n]/N1[n-1]
lambda.est2 <- N2[n]/N2[n-1]
lambda.est3 <- N3[n]/N3[n-1]
``` 




* Når populasjonsveksten er stabil (etter noen tidssteg), vil også andelen individer i hvert stadie gå mot en konstant (stabil) struktur, $\mathbf{u}=[u_1, u_2, u_3, u_4, u_5]$. <br>


* Finn den stabile strukturen ved hjelp av R-funksjonen for populasjonsvekst. Lag et barplott som viser strukturen.

```{r }
#Her kan vi bruke siste tidssteg i simuleringene vi gjorde før, for å få stabil struktur må populasjonsvektoren skaleres slik at den summerer til en (slik at hvert element blir en andel)
n <- length(N1)
stabil.struktur1 <- sim1[,n]/N1[n]
stabil.struktur2 <- sim2[,n]/N2[n]
stabil.struktur3 <- sim3[,n]/N3[n]

``` 


```{r, fig.width=6, fig.height=6}
#For barplottet bruker vi kun den ene
par(mfrow=c(1,1), bty="l", cex=1)
names(stabil.struktur1) <- c("Nyklekket", "Liten juv", "Stor juv", "Sub-adult", "Adult") 
barplot(stabil.struktur1, main ="Stabil stadiestruktur" , ylim=c(0,1), col=1:5)

``` 

<br>


* Den reproduktive verdien for hvert stadie, $\mathbf{v}=[v_1, v_2, v_3, v_4, v_5]$ forteller oss hvor mye individer i det stadie bidrar til fremtidig populasjonsvekst, sammenliknet med andre stadier. Dette er en vektor som kan skaleres på ulike måter, en vanlig skalering er å definere $v_1=1$ og skalere de andre verdiene deretter. Det er flere måter å finne den reproduktive verdien på, men en enkel måte er å regne ut forskjellen i populasjonsstørrelse etter lang tid, gitt at man starter populasjonsveksten med individer i kun et stadie.

En måte å regne ut reproduktiv verdi på er å simulere populasjonsvekst der man starter med  individer kun i et stadie om gangen. Den relative forskjellen i populasjonsstørrelse etter lang tid tilsvarer reproduktiv verdi.  

* Basert på dette og R-funksjonen for populasjonsvekst, finn den reproduktive verdien til hvert stadie. Lag et barplott for disse verdiene. Hva ser du? Basert på dette, hvilket stadie er viktigst for den langsiktige populasjonsveksten?

```{r }
#Først må vi gjøre en simulering for hvert av stadiene, der vi starter populasjonen med individer kun i det stadiet:

sim.v1 <- Popvekst(N0=c(50,0,0,0,0))
sim.v2 <- Popvekst(N0=c(0,50,0,0,0))
sim.v3 <- Popvekst(N0=c(0,0,50,0,0))
sim.v4 <- Popvekst(N0=c(0,0,0,50,0))
sim.v5 <- Popvekst(N0=c(0,0,0,0,50))

#Deretter henter vi ut total populasjon:

N.v1 <- apply(sim.v1,2,sum)
N.v2 <- apply(sim.v2,2,sum)
N.v3 <- apply(sim.v3,2,sum)
N.v4 <- apply(sim.v4,2,sum)
N.v5 <- apply(sim.v5,2,sum)

#Deretter henter vi ut siste verdi fra hver:
n<-length(N.v1)
N.v <- c(N.v1[n], N.v2[n], N.v3[n], N.v4[n], N.v5[n])

#Tilslutt skalerer vi slik at v1=1
reproduktiv.verdi <- N.v/N.v[1]
``` 


```{r, fig.width=6, fig.height=6}
par(mfrow=c(1,1), bty="l", cex=1)
names(reproduktiv.verdi) <- c("Nyklekket", "Liten juv", "Stor juv", "Sub-adult", "Adult") 
barplot(reproduktiv.verdi, main ="Reproduktiv verdi" , ylim=c(0,max(reproduktiv.verdi)), col=1:5)

``` 


<br>

###Oppgave 3 Hvordan øke populasjonsveksten
For å bevare populasjonen må vi øke populasjonsvekstraten $\lambda$ slik at denne blir minst 1 (stabil populasjon) eller større. For å få til dette må tiltak settes inn slik at man øker overlevelsen i ulike stadier, eller eventuelt reproduksjonen. 
 
*  I første omgang kan du velge mellom tiltak som øker overlevelsen, men du kan kun gjøre det for ett av stadiene. Derfor må du finne ut hvor mye overlevelsen må økes i hvert av stadieene for å oppnå $\lambda\approx 1$ (og er dette overhodet mulig for alle stadier).  Her kan du bruke R-funksjonen for populasjonsvekst: Oppdater stadie-matrisa for hver overlevelse som undersøkes (tips: husk å lagre disse med nye navn i R slik at du ikke overskriver den gamle matrisa). Husk at overlevelsen påvirker flere av parameterne.


```{r}
#Her må vi oppdatere både P, G, og F:

p.ny <- c(.67 , .74, .74, .74, .81) #Oppdatere et element om gangen
P.ny <-  ((1-p.ny^(d-1))/(1-p.ny^d))*p.ny
G.ny <- p.ny^d*(1-p.ny)/(1-p.ny^d) 
F4.ny <- G.ny[4]* m[5] 
F5.ny <- P.ny[5]* m[5]  

#Deretter må stadiematrisa oppdateres:

Lmat.ny <- matrix(NA, 5, 5)

Lmat.ny[1,] <- c(P.ny[1], 0, 0, F4.ny, F5.ny)
Lmat.ny[2,] <- c(G.ny[1], P.ny[2], 0, 0, 0)
Lmat.ny[3,] <- c(0, G.ny[2], P.ny[3],  0, 0)
Lmat.ny[4,] <- c(0, 0, G.ny[3], P.ny[4], 0)
Lmat.ny[5,] <- c(0, 0, 0, G.ny[4], P.ny[5])

#Gjør ny simulering av populasjonsvekst
sim.ny <- Popvekst(L=Lmat.ny)
N.ny <- apply(sim.ny, 2, sum)
n <- length(N.ny)

#Finn lambda (prøv og feil for lambda ca 1)
 N.ny[n]/N.ny[n-1]  
``` 




```{r}
#Lagre overlevelses-verdier i vektor (fyll inn manuelt basert på prøving/feiling over)
p.lambda1 <- c(.9999, .83, .82, .84,.91)

#NB: For nyklekkede er det ikke mulig å oppnå lambda lik 1. Max verdi er ca 0.98.

#Prosentvis økning som må til:
p.increase <- p.lambda1/p-1
``` 

* Lag to barplott som viser 1) hva overlevelsen må økes til i hvert stadie for å få $\lambda\approx 1$ (eventuelt så høy som mulig), dersom overlevelsen de andre stadiene holdes konstant lik verdiene i tabell 1, og 2) den prosentvise økningen i overlevelse som eventuelt må til i hvert stadie. Hva vil du anbefale av tiltak, basert på disse resultatene?

```{r, fig.width=12, fig.height=5}
par(mfrow=c(1,2), bty="l", cex=1)
names(p.lambda1) <- c("Nyklekket", "Liten juv", "Stor juv", "Sub-adult", "Adult") 
barplot(p.lambda1, main ="p som gir lambda = 1" , ylim=c(0,1 ), col=1:5)

names(p.increase) <- c("Nyklekket", "Liten juv", "Stor juv", "Sub-adult", "Adult") 
barplot(p.increase*100, main ="% okning p som gir lambda=1" , ylim=c(0,100), col=1:5)

``` 



* En annen mulighet er å øke fekunditeten $m$. Hvor mye må denne økes for å oppnå $\lambda\approx 1$?



```{r}
#Her holder det å oppdatere fekunditeten

Fek.ny <- 100

F4.ny <- G[4]* Fek.ny 
F5.ny <- P[5]* Fek.ny  

#Deretter må stadiematrisa oppdateres:

Lmat.ny <- matrix(NA, 5, 5)

Lmat.ny[1,] <- c(P[1], 0, 0, F4.ny, F5.ny)
Lmat.ny[2,] <- c(G[1], P[2], 0, 0, 0)
Lmat.ny[3,] <- c(0, G[2], P[3],  0, 0)
Lmat.ny[4,] <- c(0, 0, G[3], P[4], 0)
Lmat.ny[5,] <- c(0, 0, 0, G[4], P[5])

#Gjør ny simulering av populasjonsvekst
sim.ny <- Popvekst(L=Lmat.ny)
N.ny <- apply(sim.ny, 2, sum)
n <- length(N.ny)

#Finn lambda (prøv og feil for lambda ca 1)
 N.ny[n]/N.ny[n-1]  
 
Fek.lambda1 <- 160

#Prosentvis økning

(Fek.lambda1/m[5]-1)*100
``` 
<br>
  


* Basert på det du har funnet ut  i de tidligere oppgavene, og det du har lært om livshistorie, hvilke råd vil du gi om bevaring av denne populasjonen? Hvilke stadier bør man bruke mest ressurser på (gitt at ressurser er begrenset)?  Hvilke antakelser må man være obs på i disse modellene? Hva tar de ikke hensyn til?

<br>

###Bakgrunnsmateriale

$^1$Crowder, L. B, Crouse, D. T., Heppel, S., and Martin, T. H. Predicting the Impact of Turtle Excluder Devices on Loggerhead Sea Turtle Populations. 1994. Ecological Applications 4:437-445.

$^2$Crouse, D. T. Crowder, L. B. and  Caswell, H. A stage-based population model for loggerhead sea turtles and implications for conservation. 1987. Ecology 68: 1412-1423.

$^2$Lineær algebra av matrisemodeller.








